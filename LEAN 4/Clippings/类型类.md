## 10\. ç±»å‹ç±»ğŸ”—

ç±»å‹ç±»ï¼ˆType Classï¼‰ä½œä¸ºä¸€ç§åŸåˆ™æ€§æ–¹æ³•å¼•å…¥ï¼Œæ˜¯ä¸ºäº†åœ¨å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ä¸­æ”¯æŒç‰¹è®¾å¤šæ€ï¼ˆAd-hoc Polymorphismï¼‰ã€‚ æˆ‘ä»¬é¦–å…ˆè§‚å¯Ÿåˆ°ï¼Œå¦‚æœå‡½æ•°ç®€å•åœ°æ¥å—ç‰¹å®šç±»å‹çš„å®ç°ä½œä¸ºå‚æ•°ï¼Œç„¶ååœ¨å…¶ä½™å‚æ•°ä¸Šè°ƒç”¨è¯¥å®ç°ï¼Œ åˆ™å¾ˆå®¹æ˜“å®ç°ç‰¹è®¾å¤šæ€å‡½æ•°ï¼ˆå¦‚åŠ æ³•ï¼‰ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬åœ¨ Lean ä¸­å£°æ˜ä¸€ä¸ªç»“æ„ä½“æ¥ä¿å­˜åŠ æ³•çš„å®ç°ï¼š

`structureAdd(Î±:Type)whereadd:Î±â†’Î±â†’Î±` `` `@Add.add : {Î±:Type}â†’AddÎ±â†’Î±â†’Î±â†’Î±`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")@Add.add ``
```
@Add.add : {Î± : Type} â†’ Add Î± â†’ Î± â†’ Î± â†’ Î±
```

`defdouble(s:AddÎ±)(x:Î±):Î±:=s.addxx` `` `20`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")double{add:=[Nat.add](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___add "Documentation for Nat.add in Lean Language Reference")}10 ``
```
20
```
`` `100`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")double{add:=[Nat.mul](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___mul "Documentation for Nat.mul in Lean Language Reference")}10 ``
```
100
```
`` `20`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")double{add:=[Int.add](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___add "Documentation for Int.add in Lean Language Reference")}10 ``
```
20
```

`classAdd(Î±:Type)whereadd:Î±â†’Î±â†’Î±` `` `@Add.add : {Î±:Type}â†’[self:AddÎ±]â†’Î±â†’Î±â†’Î±`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")@Add.add ``
```
@Add.add : {Î± : Type} â†’ [self : Add Î±] â†’ Î± â†’ Î± â†’ Î±
```

å…¶ä¸­æ–¹æ‹¬å·è¡¨ç¤ºç±»å‹ä¸º `AddÎ±` çš„å‚æ•°æ˜¯ *å®ä¾‹éšå¼çš„* ï¼Œ å³ï¼Œå®ƒåº”è¯¥ä½¿ç”¨ç±»å‹ç±»è§£æåˆæˆã€‚è¿™ä¸ªç‰ˆæœ¬çš„ `add` æ˜¯ Haskell é¡¹ `add :: Add a => a -> a -> a` çš„ Lean ç±»æ¯”ã€‚ åŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ³¨å†Œå®ä¾‹ï¼š

`instance:Add[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")whereadd:=[Nat.add](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___add "Documentation for Nat.add in Lean Language Reference")` `instance:Add[Int](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___ofNat "Documentation for Int in Lean Language Reference")whereadd:=[Int.add](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___add "Documentation for Int.add in Lean Language Reference")` `instance:Add[Float](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Floating-Point-Numbers/#Float-next "Documentation for Float in Lean Language Reference")whereadd:=[Float.add](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Floating-Point-Numbers/#Float___add "Documentation for Float.add in Lean Language Reference")`

`defdouble[AddÎ±](x:Î±):Î±:=Add.addxx` `` `@double : {Î±:Type}â†’[AddÎ±]â†’Î±â†’Î±`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")@double ``
```
@double : {Î± : Type} â†’ [Add Î±] â†’ Î± â†’ Î±
```
`` `20`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")double10 ``
```
20
```
`` `20`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")double(10:[Int](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___ofNat "Documentation for Int in Lean Language Reference")) ``
```
20
```
`` `14.000000`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")double(7:[Float](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Floating-Point-Numbers/#Float-next "Documentation for Float in Lean Language Reference")) ``
```
14.000000
```
`` `482.000000`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")double(239.0+2) ``
```
482.000000
```

`instance[[Add](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Add___mk "Documentation for Add in Lean Language Reference")Î±]:[Add](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Add___mk "Documentation for Add in Lean Language Reference")([Array](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Arrays/#Array___mk "Documentation for Array in Lean Language Reference")Î±)where[add](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Add___mk "Documentation for Add.add in Lean Language Reference")xy:=[Array.zipWith](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Arrays/#Array___zipWith "Documentation for Array.zipWith in Lean Language Reference")(Â·+Â·)xy` `` `#[4, 6]`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")[Add.add](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Add___mk "Documentation for Add.add in Lean Language Reference")#[1,2]#[3,4] ``
```
#[4, 6]
```
`` `#[4, 6]`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")#[1,2]+#[3,4] ``
```
#[4, 6]
```

è¯·æ³¨æ„ï¼Œ `(Â·+Â·)` æ˜¯ Lean ä¸­ `funxy=>x+y` çš„è®°æ³•ã€‚

`classInhabited(Î±:Typeu)wheredefault:Î±` `` `[@](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example")[Inhabited.default](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example") : {Î±:Type u_1}â†’[self:[Inhabited](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example")Î±]â†’Î±`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")@Inhabited.default ``
```
@Inhabited.default : {Î± : Type u_1} â†’ [self : Inhabited Î±] â†’ Î±
```

`instance:[Inhabited](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example")[Bool](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Booleans/#Bool___false "Documentation for Bool in Lean Language Reference")where[default](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example"):=[true](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Booleans/#Bool___false "Documentation for Bool.true in Lean Language Reference")` `instance:[Inhabited](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example")[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")where[default](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example"):=0` `instance:[Inhabited](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example")[Unit](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/The-Unit-Type/#Unit "Documentation for Unit in Lean Language Reference")where[default](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example"):=()` `instance:[Inhabited](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example")Propwhere[default](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example"):=[True](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Truth/#True___intro "Documentation for True in Lean Language Reference")` `` `0`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")([Inhabited.default](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example"):[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")) ``
```
0
```
`` `true`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")([Inhabited.default](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example"):[Bool](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Booleans/#Bool___false "Documentation for Bool in Lean Language Reference")) ``
```
true
```

ä½ å¯ä»¥ç”¨ `export` å‘½ä»¤æ¥ä¸º `[Inhabited.default](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Inhabited___mk "Documentation for Inhabited.default in Lean Language Reference")` åˆ›å»ºåˆ«å `[default](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Inhabited___mk "Documentation for Inhabited.default in Lean Language Reference")` ã€‚

`[export](https://lean-lang.org/doc/reference/4.26.0/Namespaces-and-Sections/#Lean___Parser___Command___export "Documentation for syntax in Lean Language Reference")Inhabited([default](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example"))` `` `0`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")([default](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example"):[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")) ``
```
0
```
`` `true`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")([default](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example"):[Bool](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Booleans/#Bool___false "Documentation for Bool in Lean Language Reference")) ``
```
true
```

## 10.1. é“¾æ¥å®ä¾‹ğŸ”—

ä»¥ç±»å‹ç±»æ¨æ–­çš„å±‚é¢æ¥çœ‹ï¼Œå®ƒå¹¶ä¸é‚£ä¹ˆä»¤äººå°è±¡æ·±åˆ»ï¼› å®ƒä¸è¿‡æ˜¯ä¸€ç§ä¸ºç²¾ç»†å™¨å­˜å‚¨å®ä¾‹åˆ—è¡¨çš„æœºåˆ¶ï¼Œç”¨äºåœ¨æŸ¥è¯¢è¡¨ä¸­æŸ¥æ‰¾ã€‚ ç±»å‹ç±»æ¨æ–­å˜å¾—å¼ºå¤§çš„åŸå› åœ¨äºï¼Œå®ƒèƒ½å¤Ÿâ€œé“¾æ¥ï¼ˆChainï¼‰â€å®ä¾‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ å®ä¾‹å£°æ˜æœ¬èº«å¯ä»¥ä¾èµ–ç±»å‹ç±»çš„éšå¼å®ä¾‹ã€‚ è¿™å¯¼è‡´ç±»æ¨æ–­é€’å½’åœ°é€šè¿‡å®ä¾‹è¿›è¡Œé“¾æ¥ï¼Œå¹¶åœ¨å¿…è¦æ—¶å›æº¯ï¼Œå°±åƒ Prolog ä¸­çš„æœç´¢ä¸€æ ·ã€‚

`instance[[Inhabited](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Inhabited___mk "Documentation for Inhabited in Lean Language Reference")Î±][[Inhabited](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Inhabited___mk "Documentation for Inhabited in Lean Language Reference")Î²]:[Inhabited](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Inhabited___mk "Documentation for Inhabited in Lean Language Reference")(Î±Ã—Î²)where[default](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Inhabited___mk "Documentation for Inhabited.default in Lean Language Reference"):=([default](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Inhabited___mk "Documentation for Inhabited.default in Lean Language Reference"),[default](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Inhabited___mk "Documentation for Inhabited.default in Lean Language Reference"))`

å°†å®ƒæ·»åŠ åˆ°å…ˆå‰çš„å®ä¾‹å£°æ˜åï¼Œç±»å‹ç±»å®ä¾‹å°±èƒ½æ¨å¯¼äº†ï¼Œä¾‹å¦‚ `[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")Ã—[Bool](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Booleans/#Bool___false "Documentation for Bool in Lean Language Reference")` çš„é»˜è®¤å…ƒç´ ä¸ºï¼š

`instance[[Inhabited](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example")Î±][[Inhabited](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example")Î²]:[Inhabited](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example")(Î±Ã—Î²)where[default](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___Inhabited "Definition of example"):=(default,default)` `` `(0, true)`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")(default:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")Ã—[Bool](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Booleans/#Bool___false "Documentation for Bool in Lean Language Reference")) ``
```
(0, true)
```

ä¸æ­¤ç±»ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åˆé€‚çš„å¸¸é‡å‡½æ•°ä½¿å…¶å±…ç•™åˆ°ç±»å‹å‡½æ•°ä¸­ï¼š

`instance[[Inhabited](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Inhabited___mk "Documentation for Inhabited in Lean Language Reference")Î²]:[Inhabited](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Inhabited___mk "Documentation for Inhabited in Lean Language Reference")(Î±â†’Î²)where[default](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Inhabited___mk "Documentation for Inhabited.default in Lean Language Reference"):=fun_=>[default](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Inhabited___mk "Documentation for Inhabited.default in Lean Language Reference")`

ä½œä¸ºç»ƒä¹ ï¼Œè¯·å°è¯•ä¸ºå…¶ä»–ç±»å‹å®šä¹‰é»˜è®¤å®ä¾‹ï¼Œä¾‹å¦‚ `[List](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Linked-Lists/#List___nil "Documentation for List in Lean Language Reference")` å’Œ `[Sum](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Sum-Types/#Sum___inl "Documentation for Sum in Lean Language Reference")` ç±»å‹ã€‚

`` `@[reducible] definferInstance.{u} : {Î±:Sort u}â†’[i:Î±]â†’Î± :=fun{Î±}[i:Î±]=>i`#printinferInstance ``
```
@[reducible] def inferInstance.{u} : {Î± : Sort u} â†’ [i : Î±] â†’ Î± :=
fun {Î±} [i : Î±] => i
```

## 10.2. ToString æ–¹æ³•ğŸ”—

`structurePersonwherename:[String](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Strings/#String___ofByteArray "Documentation for String in Lean Language Reference")age:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")` `instance:ToString[Person](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Person "Definition of example")wheretoStringp:=p.[name](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Person "Definition of example")++"@"++toStringp.[age](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Person "Definition of example")` `` `"Leo@542"`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")toString{[name](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Person "Definition of example"):="Leo",[age](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Person "Definition of example"):=542:[Person](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Person "Definition of example")} ``
```
"Leo@542"
```
`` `"(Daniel@18, hello)"`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")toString({[name](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Person "Definition of example"):="Daniel",[age](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Person "Definition of example"):=18:[Person](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Person "Definition of example")},"hello") ``
```
"(Daniel@18, hello)"
```

## 10.3. æ•°å€¼ğŸ”—

æ•°å€¼åœ¨ Lean ä¸­æ˜¯å¤šæ€çš„ã€‚ä½ å¯ä»¥ç”¨ä¸€ä¸ªæ•°å€¼ï¼ˆä¾‹å¦‚ `2` ï¼‰æ¥è¡¨ç¤ºä»»ä½•å®ç°äº†ç±»å‹ç±» `[OfNat](https://lean-lang.org/doc/reference/4.26.0/Terms/Numeric-Literals/#OfNat___mk "Documentation for OfNat in Lean Language Reference")` çš„ç±»å‹ä¸­çš„ä¸€ä¸ªå…ƒç´ ã€‚

`structureRationalwherenum:[Int](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___ofNat "Documentation for Int in Lean Language Reference")den:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")inv:denâ‰ 0` `instance:[OfNat](https://lean-lang.org/doc/reference/4.26.0/Terms/Numeric-Literals/#OfNat___mk "Documentation for OfNat in Lean Language Reference")Rationalnwhere[ofNat](https://lean-lang.org/doc/reference/4.26.0/Terms/Numeric-Literals/#OfNat___mk "Documentation for OfNat.ofNat in Lean Language Reference"):={num:=n,den:=1,inv:=n:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")âŠ¢ 1â‰ 0All goals completed! ğŸ™}` `instance:ToStringRationalwheretoStringr:=s!"{r.num}/{r.den}"` `` `2/1`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")(2:Rational) ``
```
2/1
```
`` `2 : Rational`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")(2:Rational) ``
```
2 : Rational
```
`` `2 : [Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")(2:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")) ``
```
2 : Nat
```

`` `2 : [Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")nat_lit2 ``
```
2 : Nat
```

åŸå§‹è‡ªç„¶æ•° *ä¸æ˜¯* å¤šæ€çš„ã€‚

`[OfNat](https://lean-lang.org/doc/reference/4.26.0/Terms/Numeric-Literals/#OfNat___mk "Documentation for OfNat in Lean Language Reference")` å®ä¾‹å¯¹æ•°å€¼è¿›è¡Œäº†å‚æ•°åŒ–ï¼Œå› æ­¤ä½ å¯ä»¥å®šä¹‰ç‰¹å®šæ•°å­—çš„å®ä¾‹ã€‚ ç¬¬äºŒä¸ªå‚æ•°é€šå¸¸æ˜¯å˜é‡ï¼Œå¦‚ä¸Šä¾‹æ‰€ç¤ºï¼Œæˆ–è€…æ˜¯ä¸€ä¸ª *åŸå§‹* è‡ªç„¶æ•°ã€‚

`classMonoid(Î±:Typeu)whereunit:Î±op:Î±â†’Î±â†’Î±` `instance[s:[Monoid](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Monoid "Definition of example")Î±]:[OfNat](https://lean-lang.org/doc/reference/4.26.0/Terms/Numeric-Literals/#OfNat___mk "Documentation for OfNat in Lean Language Reference")Î±(nat_lit1)where[ofNat](https://lean-lang.org/doc/reference/4.26.0/Terms/Numeric-Literals/#OfNat___mk "Documentation for OfNat.ofNat in Lean Language Reference"):=s.[unit](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Monoid "Definition of example")` `defgetUnit[[Monoid](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Monoid "Definition of example")Î±]:Î±:=1`

## 10.4. è¾“å‡ºå‚æ•°ğŸ”—

`/-- error: typeclass instance problem is stuck, it is often due to metavariables   Inhabited (Nat Ã— ?m.2) -/[#guard_msgs](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___guardMsgsCmd "Documentation for syntax in Lean Language Reference")(error)[in](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___guardMsgsCmd "Documentation for syntax in Lean Language Reference")[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")([inferInstance](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Synthesis/#inferInstance "Documentation for inferInstance in Lean Language Reference"):[Inhabited](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Inhabited___mk "Documentation for Inhabited in Lean Language Reference")([Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")Ã—_))`

ä½ å¯ä»¥å°†ç±»å‹ç±» `[Inhabited](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Inhabited___mk "Documentation for Inhabited in Lean Language Reference")` çš„å‚æ•°è§†ä¸ºç±»å‹ç±»åˆæˆå™¨çš„ *è¾“å…¥* å€¼ã€‚ å½“ç±»å‹ç±»æœ‰å¤šä¸ªå‚æ•°æ—¶ï¼Œå¯ä»¥å°†å…¶ä¸­ä¸€äº›æ ‡è®°ä¸º *è¾“å‡ºå‚æ•°* ï¼ˆOutput Parameterï¼‰ã€‚ å³ä½¿è¿™äº›å‚æ•°æœ‰ç¼ºå¤±éƒ¨åˆ†ï¼ŒLean ä¹Ÿä¼šå¼€å§‹ç±»å‹ç±»åˆæˆã€‚ åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨è¾“å‡ºå‚æ•°å®šä¹‰ä¸€ä¸ª *å¼‚è´¨ï¼ˆHeterogeneousï¼‰* çš„å¤šæ€ä¹˜æ³•ã€‚

`classHMul(Î±:Typeu)(Î²:Typev)(Î³:[outParam](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Synthesis/#outParam "Documentation for outParam in Lean Language Reference")(Typew))wherehMul:Î±â†’Î²â†’Î³` `[export](https://lean-lang.org/doc/reference/4.26.0/Namespaces-and-Sections/#Lean___Parser___Command___export "Documentation for syntax in Lean Language Reference")HMul(hMul)` `instance:HMul[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")wherehMul:=[Nat.mul](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___mul "Documentation for Nat.mul in Lean Language Reference")` `instance:HMul[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")([Array](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Arrays/#Array___mk "Documentation for Array in Lean Language Reference")[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference"))([Array](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Arrays/#Array___mk "Documentation for Array in Lean Language Reference")[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference"))wherehMulabs:=bs.[map](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Arrays/#Array___map "Documentation for Array.map in Lean Language Reference")(funb=>hMulab)` `` `12`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")hMul43 ``
```
12
```
`` `#[8, 12, 16]`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")hMul4#[2,3,4] ``
```
#[8, 12, 16]
```

å‚æ•° `Î±` å’Œ `Î²` ä¼šè¢«è§†ä¸ºè¾“å…¥å‚æ•°ï¼Œ `Î³` è¢«è§†ä¸ºè¾“å‡ºå‚æ•°ã€‚ å¦‚æœç»™å®šä¸€ä¸ªåº”ç”¨ `hMulab` ï¼Œé‚£ä¹ˆåœ¨çŸ¥é“ `a` å’Œ `b` çš„ç±»å‹åï¼Œ å°†è°ƒç”¨ç±»å‹ç±»åˆæˆå™¨ï¼Œå¹¶ä¸”å¯ä»¥ä»è¾“å‡ºå‚æ•° `Î³` ä¸­è·å¾—æœ€ç»ˆçš„ç±»å‹ã€‚ åœ¨ä¸Šæ–‡ä¸­çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªå®ä¾‹ã€‚ç¬¬ä¸€ä¸ªå®ä¾‹æ˜¯é’ˆå¯¹è‡ªç„¶æ•°çš„åŒè´¨ä¹˜æ³•ã€‚ ç¬¬äºŒä¸ªå®ä¾‹æ˜¯é’ˆå¯¹æ•°ç»„çš„æ ‡é‡ä¹˜æ³•ã€‚è¯·æ³¨æ„ï¼Œä½ å¯ä»¥é“¾æ¥å®ä¾‹ï¼Œå¹¶æ¨å¹¿ç¬¬äºŒä¸ªå®ä¾‹ã€‚

`classHMul(Î±:Typeu)(Î²:Typev)(Î³:[outParam](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Synthesis/#outParam "Documentation for outParam in Lean Language Reference")(Typew))wherehMul:Î±â†’Î²â†’Î³` `[export](https://lean-lang.org/doc/reference/4.26.0/Namespaces-and-Sections/#Lean___Parser___Command___export "Documentation for syntax in Lean Language Reference")HMul(hMul)` `instance:HMul[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")wherehMul:=[Nat.mul](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___mul "Documentation for Nat.mul in Lean Language Reference")` `instance:HMul[Int](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___ofNat "Documentation for Int in Lean Language Reference")[Int](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___ofNat "Documentation for Int in Lean Language Reference")[Int](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___ofNat "Documentation for Int in Lean Language Reference")wherehMul:=[Int.mul](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___mul "Documentation for Int.mul in Lean Language Reference")` `instance[HMulÎ±Î²Î³]:HMulÎ±([Array](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Arrays/#Array___mk "Documentation for Array in Lean Language Reference")Î²)([Array](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Arrays/#Array___mk "Documentation for Array in Lean Language Reference")Î³)wherehMulabs:=bs.[map](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Arrays/#Array___map "Documentation for Array.map in Lean Language Reference")(funb=>hMulab)` `` `12`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")hMul43 ``
```
12
```
`` `#[8, 12, 16]`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")hMul4#[2,3,4] ``
```
#[8, 12, 16]
```
`` `#[-6, 2, -8]`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")hMul(-2)#[3,-1,4] ``
```
#[-6, 2, -8]
```
`` `#[#[4, 6], #[0, 8]]`[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")hMul2#[#[2,3],#[0,4]] ``
```
#[#[4, 6], #[0, 8]]
```

å½“ä½ æ‹¥æœ‰ `HMulÎ±Î²Î³` çš„å®ä¾‹æ—¶ï¼Œå¯ä»¥åœ¨ç±»å‹ä¸º `[Array](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Arrays/#Array___mk "Documentation for Array in Lean Language Reference")Î²` çš„æ•°ç»„ä¸Šå°†å…¶ä½¿ç”¨æ ‡é‡ç±»å‹ `Î±` çš„æ–°æ ‡é‡æ•°ç»„ä¹˜æ³•å®ä¾‹ã€‚åœ¨æœ€åçš„ `#eval` ä¸­ï¼Œè¯·æ³¨æ„è¯¥å®ä¾‹æ›¾åœ¨æ•°ç»„æ•°ç»„ä¸­ä½¿ç”¨äº†ä¸¤æ¬¡ã€‚

è¾“å‡ºå‚æ•°åœ¨å®ä¾‹åˆæˆæœŸé—´è¢«å¿½ç•¥ã€‚å³ä½¿å®ä¾‹åˆæˆå‘ç”Ÿåœ¨è¾“å‡ºå‚æ•°çš„å€¼å·²ç»ç¡®å®šçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå®ƒä»¬çš„å€¼ä¹Ÿä¼šè¢«å¿½ç•¥ã€‚ ä¸€æ—¦ä½¿ç”¨å…¶è¾“å…¥å‚æ•°æ‰¾åˆ°å®ä¾‹ï¼ŒLean å°±ä¼šç¡®ä¿è¾“å‡ºå‚æ•°çš„å·²çŸ¥å€¼ä¸æ‰¾åˆ°çš„å€¼åŒ¹é…ã€‚

Lean è¿˜å…·æœ‰ ï¼ˆSemi-output Parameterï¼‰ï¼Œå®ƒå…·æœ‰è¾“å…¥å‚æ•°çš„ä¸€äº›ç‰¹å¾å’Œè¾“å‡ºå‚æ•°çš„ä¸€äº›ç‰¹å¾ã€‚ ä¸è¾“å…¥å‚æ•°ä¸€æ ·ï¼Œåœ¨é€‰æ‹©å®ä¾‹æ—¶ä¼šè€ƒè™‘åŠè¾“å‡ºå‚æ•°ã€‚ä¸è¾“å‡ºå‚æ•°ä¸€æ ·ï¼Œå®ƒä»¬å¯ä»¥ç”¨äºå®ä¾‹åŒ–æœªçŸ¥å€¼ã€‚ ç„¶è€Œï¼Œå®ƒä»¬å¹¶ä¸å”¯ä¸€åœ°è¿™æ ·åšã€‚ä½¿ç”¨åŠè¾“å‡ºå‚æ•°è¿›è¡Œå®ä¾‹åˆæˆå¯èƒ½æ›´éš¾ä»¥é¢„æµ‹ï¼Œ å› ä¸ºè€ƒè™‘å®ä¾‹çš„é¡ºåºå¯ä»¥å†³å®šé€‰æ‹©å“ªä¸€ä¸ªï¼Œä½†å®ƒä¹Ÿæ›´çµæ´»ã€‚

## 10.5. é»˜è®¤å®ä¾‹ğŸ”—

åœ¨ç±» `HMul` ä¸­ï¼Œå‚æ•° `Î±` å’Œ `Î²` è¢«å½“åšè¾“å…¥å€¼ã€‚ å› æ­¤ï¼Œç±»å‹ç±»åˆæˆä»…åœ¨å·²çŸ¥è¿™ä¸¤ç§ç±»å‹æ—¶æ‰å¼€å§‹ã€‚è¿™é€šå¸¸å¯èƒ½è¿‡äºä¸¥æ ¼ã€‚

`classHMul(Î±:Typeu)(Î²:Typev)(Î³:[outParam](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Synthesis/#outParam "Documentation for outParam in Lean Language Reference")(Typew))wherehMul:Î±â†’Î²â†’Î³` `[export](https://lean-lang.org/doc/reference/4.26.0/Namespaces-and-Sections/#Lean___Parser___Command___export "Documentation for syntax in Lean Language Reference")HMul(hMul)` `instance:HMul[Int](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___ofNat "Documentation for Int in Lean Language Reference")[Int](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___ofNat "Documentation for Int in Lean Language Reference")[Int](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___ofNat "Documentation for Int in Lean Language Reference")wherehMul:=[Int.mul](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___mul "Documentation for Int.mul in Lean Language Reference")` `defxs:[List](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Linked-Lists/#List___nil "Documentation for List in Lean Language Reference")[Int](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___ofNat "Documentation for Int in Lean Language Reference"):=[1,2,3]` ``/-- error: typeclass instance problem is stuck   HMul Int ?m.2 (?m.11 y)  Note: Lean will not try to resolve this typeclass instance problem because the second type argument to `HMul` is a metavariable. This argument must be fully determined before Lean will try to resolve the typeclass.  Hint: Adding type annotations and supplying implicit arguments to functions can give Lean more information for typeclass resolution. For example, if you have a variable `x` that you intend to be a `Nat`, but Lean reports it as having an unresolved type like `?m`, replacing `x` with `(x : Nat)` can get typeclass resolution un-stuck. -/[#guard_msgs](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___guardMsgsCmd "Documentation for syntax in Lean Language Reference")(error)[in](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___guardMsgsCmd "Documentation for syntax in Lean Language Reference")[#eval](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___eval "Documentation for syntax in Lean Language Reference")funy=>xs.[map](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Linked-Lists/#List___map "Documentation for List.map in Lean Language Reference")(funx=>hMulxy)``

å®ä¾‹ `HMul` æ²¡æœ‰è¢« Lean åˆæˆï¼Œå› ä¸ºæ²¡æœ‰æä¾› `y` çš„ç±»å‹ã€‚ ç„¶è€Œï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè‡ªç„¶åº”è¯¥è®¤ä¸º `y` å’Œ `x` çš„ç±»å‹åº”è¯¥ç›¸åŒã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ *é»˜è®¤å®ä¾‹* æ¥å®ç°è¿™ä¸€ç‚¹ã€‚

`classHMul(Î±:Typeu)(Î²:Typev)(Î³:[outParam](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Synthesis/#outParam "Documentation for outParam in Lean Language Reference")(Typew))wherehMul:Î±â†’Î²â†’Î³` `[export](https://lean-lang.org/doc/reference/4.26.0/Namespaces-and-Sections/#Lean___Parser___Command___export "Documentation for syntax in Lean Language Reference")HMul(hMul)` `@[[default_instance](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Declarations/#Lean___Parser___Attr___default_instance "Documentation for syntax in Lean Language Reference")]instance:HMul[Int](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___ofNat "Documentation for Int in Lean Language Reference")[Int](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___ofNat "Documentation for Int in Lean Language Reference")[Int](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___ofNat "Documentation for Int in Lean Language Reference")wherehMul:=[Int.mul](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___mul "Documentation for Int.mul in Lean Language Reference")` `defxs:[List](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Linked-Lists/#List___nil "Documentation for List in Lean Language Reference")[Int](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___ofNat "Documentation for Int in Lean Language Reference"):=[1,2,3]` `` `funy=>[List.map](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Linked-Lists/#List___map "Documentation for List.map in Lean Language Reference")(funx=>hMulxy)xs : [Int](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___ofNat "Documentation for Int in Lean Language Reference")â†’[List](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Linked-Lists/#List___nil "Documentation for List in Lean Language Reference")[Int](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___ofNat "Documentation for Int in Lean Language Reference")`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")funy=>xs.[map](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Linked-Lists/#List___map "Documentation for List.map in Lean Language Reference")(funx=>hMulxy) ``
```
fun y => List.map (fun x => hMul x y) xs : Int â†’ List Int
```

`structureRationalwherenum:[Int](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Integers/#Int___ofNat "Documentation for Int in Lean Language Reference")den:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")inv:denâ‰ 0` `@[[default_instance](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Declarations/#Lean___Parser___Attr___default_instance "Documentation for syntax in Lean Language Reference")200]instance:[OfNat](https://lean-lang.org/doc/reference/4.26.0/Terms/Numeric-Literals/#OfNat___mk "Documentation for OfNat in Lean Language Reference")Rationalnwhere[ofNat](https://lean-lang.org/doc/reference/4.26.0/Terms/Numeric-Literals/#OfNat___mk "Documentation for OfNat.ofNat in Lean Language Reference"):={num:=n,den:=1,inv:=n:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")âŠ¢ 1â‰ 0All goals completed! ğŸ™}` `instance:ToStringRationalwheretoStringr:=s!"{r.num}/{r.den}"` `` `2 : Rational`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")2 ``
```
2 : Rational
```

`classOfNat(Î±:Typeu)(n:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference"))whereofNat:Î±` `@[[default_instance](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Declarations/#Lean___Parser___Attr___default_instance "Documentation for syntax in Lean Language Reference")]instance(n:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")):[OfNat](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___OfNat "Definition of example")[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")nwhere[ofNat](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___OfNat "Definition of example"):=n` `classHMul(Î±:Typeu)(Î²:Typev)(Î³:[outParam](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Synthesis/#outParam "Documentation for outParam in Lean Language Reference")(Typew))wherehMul:Î±â†’Î²â†’Î³` `classMul(Î±:Typeu)wheremul:Î±â†’Î±â†’Î±` `@[[default_instance](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Declarations/#Lean___Parser___Attr___default_instance "Documentation for syntax in Lean Language Reference")10]instance[[Mul](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___OfNat "Definition of example")Î±]:HMulÎ±Î±Î±wherehMulab:=[Mul.mul](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Ex___OfNat "Definition of example")ab` `infixl:70" * "=>HMul.hMul`

`Mul` ç±»æ˜¯ä»…å®ç°äº†åŒè´¨ä¹˜æ³•çš„ç±»å‹çš„ç®€ä¾¿è®°æ³•ã€‚

## 10.6. å±€éƒ¨å®ä¾‹ğŸ”—

ç±»å‹ç±»æ˜¯ä½¿ç”¨ Lean ä¸­çš„å±æ€§ï¼ˆAttributeï¼‰æ¥å®ç°çš„ã€‚å› æ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨ `local` ä¿®é¥°ç¬¦è¡¨æ˜å®ƒä»¬åªå¯¹å½“å‰ `section` æˆ– `namespace` å…³é—­ä¹‹å‰æˆ–å½“å‰æ–‡ä»¶ç»“æŸä¹‹å‰æœ‰æ•ˆã€‚

`structurePointwherex:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")y:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")` `[section](https://lean-lang.org/doc/reference/4.26.0/Namespaces-and-Sections/#Lean___Parser___Command___section "Documentation for syntax in Lean Language Reference")` `localinstance:[Add](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Add___mk "Documentation for Add in Lean Language Reference")Pointwhere[add](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Add___mk "Documentation for Add.add in Lean Language Reference")ab:={x:=a.x+b.x,y:=a.y+b.y}` `defdouble(p:Point):=p+p` ``end -- instance `Add Point` is not active anymore  `` ``/-- error: failed to synthesize   HAdd Point Point ?m.5  Hint: Additional diagnostic information may be available using the `set_option diagnostics true` command. -/[#guard_msgs](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___guardMsgsCmd "Documentation for syntax in Lean Language Reference")[in](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___guardMsgsCmd "Documentation for syntax in Lean Language Reference")deftriple(p:Point):=p+p+p``

ä½ ä¹Ÿå¯ä½¿ç”¨ `attribute` å‘½ä»¤æš‚æ—¶ç¦ç”¨ä¸€ä¸ªå®ä¾‹ï¼Œç›´è‡³å½“å‰çš„ `section` æˆ– `namespace` å…³é—­ï¼Œæˆ–ç›´åˆ°å½“å‰æ–‡ä»¶çš„ç»“å°¾ã€‚

`structurePointwherex:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")y:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")` `instance:[Add](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Add___mk "Documentation for Add in Lean Language Reference")Pointwhere[add](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Add___mk "Documentation for Add.add in Lean Language Reference")ab:={x:=a.x+b.x,y:=a.y+b.y}` `defdouble(p:Point):=p+p` `[attribute](https://lean-lang.org/doc/reference/4.26.0/Attributes/#Lean___Parser___Command___attribute "Documentation for syntax in Lean Language Reference")[-instance][addPoint](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Point-next-next-next-next-next-next-next "Definition of example")` ``/-- error: failed to synthesize   HAdd Point Point ?m.5  Hint: Additional diagnostic information may be available using the `set_option diagnostics true` command. -/[#guard_msgs](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___guardMsgsCmd "Documentation for syntax in Lean Language Reference")[in](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___guardMsgsCmd "Documentation for syntax in Lean Language Reference")deftriple(p:Point):=p+p+p  -- Error: failed to synthesize instance ``

æˆ‘ä»¬å»ºè®®ä½ åªä½¿ç”¨æ­¤å‘½ä»¤æ¥è¯Šæ–­é—®é¢˜ã€‚

## 10.7. ä½œç”¨åŸŸå®ä¾‹ğŸ”—

ä½ å¯ä»¥åœ¨å‘½åç©ºé—´ä¸­å£°æ˜ä½œç”¨åŸŸå®ä¾‹ã€‚è¿™ç§ç±»å‹çš„å®ä¾‹åªåœ¨ä½ è¿›å…¥å‘½åç©ºé—´æˆ–æ‰“å¼€å‘½åç©ºé—´æ—¶æ¿€æ´»ã€‚

`structurePointwherex:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")y:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")` `[namespace](https://lean-lang.org/doc/reference/4.26.0/Namespaces-and-Sections/#Lean___Parser___Command___namespace "Documentation for syntax in Lean Language Reference")Point` `scopedinstance:[Add](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Add___mk "Documentation for Add in Lean Language Reference")Pointwhere[add](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Add___mk "Documentation for Add.add in Lean Language Reference")ab:={x:=a.x+b.x,y:=a.y+b.y}` `defdouble(p:Point):=p+p` `endPoint` ``-- instance `Add Point` is not active anymore  /-- error: failed to synthesize   HAdd Point Point ?m.3  Hint: Additional diagnostic information may be available using the `set_option diagnostics true` command. -/[#guard_msgs](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___guardMsgsCmd "Documentation for syntax in Lean Language Reference")(error)[in](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___guardMsgsCmd "Documentation for syntax in Lean Language Reference")`funp=>sorry : (p:Point)â†’?m.6p`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")fun(p:Point)=>p+p+p``
```
fun p => sorry : (p : Point) â†’ ?m.6 p
```
`[namespace](https://lean-lang.org/doc/reference/4.26.0/Namespaces-and-Sections/#Lean___Parser___Command___namespace "Documentation for syntax in Lean Language Reference")Point` ``-- instance `Add Point` is active again `funp=>p[+](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HAdd___mk "Documentation for HAdd.hAdd in Lean Language Reference")p[+](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HAdd___mk "Documentation for HAdd.hAdd in Lean Language Reference")p : Pointâ†’Point`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")fun(p:Point)=>p+p+p``
```
fun p => p + p + p : Point â†’ Point
```
`endPoint` ``[open](https://lean-lang.org/doc/reference/4.26.0/Namespaces-and-Sections/#Lean___Parser___Command___open "Documentation for syntax in Lean Language Reference")Point -- activates instance `Add Point` `` `` `funp=>p[+](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HAdd___mk "Documentation for HAdd.hAdd in Lean Language Reference")p[+](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HAdd___mk "Documentation for HAdd.hAdd in Lean Language Reference")p : Pointâ†’Point`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")fun(p:Point)=>p+p+p ``
```
fun p => p + p + p : Point â†’ Point
```

ä½ å¯ä»¥ä½¿ç”¨ `open scoped` ` <namespace>` å‘½ä»¤æ¥æ¿€æ´»ä½œç”¨åŸŸå†…çš„å±æ€§ï¼Œä½†ä¸ä¼šâ€œæ‰“å¼€â€å‘½åç©ºé—´ä¸­çš„åç§°ã€‚

`structurePointwherex:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")y:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")` `[namespace](https://lean-lang.org/doc/reference/4.26.0/Namespaces-and-Sections/#Lean___Parser___Command___namespace "Documentation for syntax in Lean Language Reference")Point` `scopedinstance:[Add](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Add___mk "Documentation for Add in Lean Language Reference")Pointwhere[add](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Add___mk "Documentation for Add.add in Lean Language Reference")ab:={x:=a.x+b.x,y:=a.y+b.y}` `defdouble(p:Point):=p+p` `endPoint` ``[open](https://lean-lang.org/doc/reference/4.26.0/Namespaces-and-Sections/#Lean___Parser___Command___open "Documentation for syntax in Lean Language Reference")[scoped](https://lean-lang.org/doc/reference/4.26.0/Namespaces-and-Sections/#Lean___Parser___Command___openScoped "Documentation for syntax in Lean Language Reference")Point -- activates instance `Add Point` `` `` `funp=>p[+](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HAdd___mk "Documentation for HAdd.hAdd in Lean Language Reference")p[+](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HAdd___mk "Documentation for HAdd.hAdd in Lean Language Reference")p : Pointâ†’Point`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")fun(p:Point)=>p+p+p ``
```
fun p => p + p + p : Point â†’ Point
```
``/-- error: Unknown identifier `double` -/[#guard_msgs](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___guardMsgsCmd "Documentation for syntax in Lean Language Reference")(error)[in](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___guardMsgsCmd "Documentation for syntax in Lean Language Reference")`funp=>sorry : (p:Point)â†’?m.2p`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")fun(p:Point)=>doublep``
```
fun p => sorry : (p : Point) â†’ ?m.2 p
```

## 10.8. å¯åˆ¤å®šçš„å‘½é¢˜ğŸ”—

è®©æˆ‘ä»¬è€ƒè™‘æ ‡å‡†åº“ä¸­å®šä¹‰çš„å¦ä¸€ä¸ªç±»å‹ç±»ï¼Œåä¸º `[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")` ç±»å‹ç±»ã€‚ ç²—ç•¥åœ°è®²ï¼Œå¯¹äº `Prop` çš„ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥åˆ¤å®šå®ƒæ˜¯çœŸæˆ–å‡ï¼Œå®ƒå°±è¢«ç§°ä¸ºå¯åˆ¤å®šçš„ã€‚ è¿™ç§åŒºåˆ«åªæœ‰åœ¨æ„é€ æ€§æ•°å­¦ä¸­æ‰æœ‰ç”¨ï¼›åœ¨ç»å…¸æ•°å­¦ä¸­ï¼Œæ¯ä¸ªå‘½é¢˜éƒ½æ˜¯å¯åˆ¤å®šçš„ã€‚ ä½†å¦‚æœæˆ‘ä»¬ä½¿ç”¨ç»å…¸åŸåˆ™ï¼Œæ¯”å¦‚é€šè¿‡æƒ…å†µæ¥å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å°†ä¸å¯è®¡ç®—ã€‚ ä»ç®—æ³•ä¸Šæ¥è®²ï¼Œ `[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")` ç±»å‹ç±»å¯ä»¥ç”¨æ¥æ¨å¯¼å‡ºä¸€ä¸ªè¿‡ç¨‹ï¼Œå®ƒèƒ½æœ‰æ•ˆåˆ¤å®šå‘½é¢˜æ˜¯å¦ä¸ºçœŸã€‚ å› æ­¤ï¼Œè¯¥ç±»å‹ç±»æ”¯æŒè¿™æ ·çš„è®¡ç®—æ€§å®šä¹‰ï¼ˆå¦‚æœå®ƒä»¬æ˜¯å¯èƒ½çš„ï¼‰ï¼Œ åŒæ—¶è¿˜å…è®¸å¹³æ»‘åœ°è¿‡æ¸¡åˆ°ç»å…¸å®šä¹‰å’Œç»å…¸æ¨ç†çš„ä½¿ç”¨ã€‚

åœ¨æ ‡å‡†åº“ä¸­ï¼Œ `[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")` çš„å½¢å¼åŒ–å®šä¹‰å¦‚ä¸‹ï¼š

`classinductiveDecidable(p:Prop)where|isFalse(h:Â¬p):Decidablep|isTrue(h:p):Decidablep`

`defite{Î±:Sortu}(c:Prop)[h:[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")c](te:Î±):Î±:=h.casesOn(motive:=fun_=>Î±)(fun_=>e)(fun_=>t)`

`defdite{Î±:Sortu}(c:Prop)[h:[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")c](t:câ†’Î±)(e:[Not](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Logical-Connectives/#Not "Documentation for Not in Lean Language Reference")câ†’Î±):Î±:=Decidable.casesOn(motive:=fun_=>Î±)het`

å¦‚æœæ²¡æœ‰ç»å…¸é€»è¾‘ï¼Œæˆ‘ä»¬å°±ä¸èƒ½è¯æ˜æ¯ä¸ªå‘½é¢˜éƒ½æ˜¯å¯åˆ¤å®šçš„ã€‚ ä½†æˆ‘ä»¬å¯ä»¥è¯æ˜ *æŸäº›* å‘½é¢˜æ˜¯å¯åˆ¤å®šçš„ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è¯æ˜åŸºæœ¬è¿ç®—ï¼ˆæ¯”å¦‚è‡ªç„¶æ•°å’Œæ•´æ•°ä¸Šçš„ç­‰å¼å’Œæ¯”è¾ƒï¼‰çš„å¯åˆ¤å®šæ€§ã€‚ æ­¤å¤–ï¼Œå‘½é¢˜è¿è¯ä¸‹çš„å¯åˆ¤å®šæ€§è¢«ä¿ç•™äº†ä¸‹æ¥ï¼š

`` `@instDecidableAnd : {pq:Prop}â†’[dp:[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")p]â†’[dq:[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")q]â†’[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")[(](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Logical-Connectives/#And___intro "Documentation for And in Lean Language Reference")p[âˆ§](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Logical-Connectives/#And___intro "Documentation for And in Lean Language Reference")q[)](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Logical-Connectives/#And___intro "Documentation for And in Lean Language Reference")`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")@instDecidableAnd ``
```
@instDecidableAnd : {p q : Prop} â†’ [dp : Decidable p] â†’ [dq : Decidable q] â†’ Decidable (p âˆ§ q)
```
`` `@instDecidableOr : {pq:Prop}â†’[dp:[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")p]â†’[dq:[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")q]â†’[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")[(](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Logical-Connectives/#Or___inl "Documentation for Or in Lean Language Reference")p[âˆ¨](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Logical-Connectives/#Or___inl "Documentation for Or in Lean Language Reference")q[)](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Logical-Connectives/#Or___inl "Documentation for Or in Lean Language Reference")`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")@instDecidableOr ``
```
@instDecidableOr : {p q : Prop} â†’ [dp : Decidable p] â†’ [dq : Decidable q] â†’ Decidable (p âˆ¨ q)
```
`` `@instDecidableNot : {p:Prop}â†’[dp:[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")p]â†’[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")[Â¬](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Logical-Connectives/#Not "Documentation for Not in Lean Language Reference")p`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")@instDecidableNot ``
```
@instDecidableNot : {p : Prop} â†’ [dp : Decidable p] â†’ Decidable Â¬p
```

å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è‡ªç„¶æ•°ä¸Šçš„å¯åˆ¤å®šè°“è¯è¿›è¡Œåˆ†æƒ…å†µå®šä¹‰ï¼š

`defstep(abx:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")):[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference"):=[if](https://lean-lang.org/doc/reference/4.26.0/Terms/Conditionals/#termIfThenElse "Documentation for syntax in Lean Language Reference")x<aâˆ¨x>b[then](https://lean-lang.org/doc/reference/4.26.0/Terms/Conditionals/#termIfThenElse "Documentation for syntax in Lean Language Reference")0[else](https://lean-lang.org/doc/reference/4.26.0/Terms/Conditionals/#termIfThenElse "Documentation for syntax in Lean Language Reference")1` `set_optionpp.explicittrue` `` `defstep : [Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")â†’[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")â†’[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")â†’[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference") :=funabx=>@ite[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")([Or](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Logical-Connectives/#Or___inl "Documentation for Or in Lean Language Reference")(@[LT.lt](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#LT___mk "Documentation for LT.lt in Lean Language Reference")[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")instLTNatxa)(@GT.gt[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")instLTNatxb))(@instDecidableOr(@[LT.lt](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#LT___mk "Documentation for LT.lt in Lean Language Reference")[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")instLTNatxa)(@GT.gt[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")instLTNatxb)([Nat.decLt](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___decLt "Documentation for Nat.decLt in Lean Language Reference")xa)([Nat.decLt](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___decLt "Documentation for Nat.decLt in Lean Language Reference")bx))(@[OfNat.ofNat](https://lean-lang.org/doc/reference/4.26.0/Terms/Numeric-Literals/#OfNat___mk "Documentation for OfNat.ofNat in Lean Language Reference")[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")(nat_lit 0)(instOfNatNat(nat_lit 0)))(@[OfNat.ofNat](https://lean-lang.org/doc/reference/4.26.0/Terms/Numeric-Literals/#OfNat___mk "Documentation for OfNat.ofNat in Lean Language Reference")[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")(nat_lit 1)(instOfNatNat(nat_lit 1)))`#printstep ``
```
def step : Nat â†’ Nat â†’ Nat â†’ Nat :=
fun a b x =>
  @ite Nat (Or (@LT.lt Nat instLTNat x a) (@GT.gt Nat instLTNat x b))
    (@instDecidableOr (@LT.lt Nat instLTNat x a) (@GT.gt Nat instLTNat x b) (Nat.decLt x a) (Nat.decLt b x))
    (@OfNat.ofNat Nat (nat_lit 0) (instOfNatNat (nat_lit 0))) (@OfNat.ofNat Nat (nat_lit 1) (instOfNatNat (nat_lit 1)))
```

æ‰“å¼€éšå¼å‚æ•°æ˜¾ç¤ºï¼Œé˜é‡Šå™¨ï¼ˆElaboratorï¼‰å·²ç»é€šè¿‡åº”ç”¨é€‚å½“çš„å®ä¾‹æ¨å¯¼å‡ºäº†å‘½é¢˜ `x<aâˆ¨x>b` çš„å¯åˆ¤å®šæ€§ã€‚

åˆ©ç”¨ç»å…¸å…¬ç†ï¼Œæˆ‘ä»¬å¯ä»¥è¯æ˜æ¯ä¸ªå‘½é¢˜éƒ½æ˜¯å¯åˆ¤å®šçš„ã€‚ ä½ å¯ä»¥å¯¼å…¥ç»å…¸å…¬ç†ï¼Œå¹¶é€šè¿‡æ‰“å¼€ `Classical` å‘½åç©ºé—´æ¥ä½¿é€šç”¨çš„å¯åˆ¤å®šæ€§å®ä¾‹å¯ç”¨ã€‚

`[open](https://lean-lang.org/doc/reference/4.26.0/Namespaces-and-Sections/#Lean___Parser___Command___open "Documentation for syntax in Lean Language Reference")Classical`

`[open](https://lean-lang.org/doc/reference/4.26.0/Namespaces-and-Sections/#Lean___Parser___Command___open "Documentation for syntax in Lean Language Reference")Classical` `noncomputablescopedinstance(priority:=[low](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Declarations/#prioLow "Documentation for syntax in Lean Language Reference"))propDecidable(a:Prop):[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")a:=choice<|[match](https://lean-lang.org/doc/reference/4.26.0/Terms/Pattern-Matching/#Lean___Parser___Term___match "Documentation for syntax in Lean Language Reference")ema[with](https://lean-lang.org/doc/reference/4.26.0/Terms/Pattern-Matching/#Lean___Parser___Term___match "Documentation for syntax in Lean Language Reference")|[Or.inl](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Logical-Connectives/#Or___inl "Documentation for Or.inl in Lean Language Reference")h=>âŸ¨[isTrue](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable.isTrue in Lean Language Reference")hâŸ©|[Or.inr](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Logical-Connectives/#Or___inl "Documentation for Or.inr in Lean Language Reference")h=>âŸ¨[isFalse](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable.isFalse in Lean Language Reference")hâŸ©`

è¿™ä¿è¯äº† Lean ä¼šä¼˜å…ˆé€‰æ‹©å…¶ä»–å®ä¾‹ï¼Œå¹¶ä¸”åªæœ‰åœ¨å…¶ä»–æ¨å¯¼å¯åˆ¤å®šæ€§çš„å°è¯•å¤±è´¥åï¼Œ æ‰ä¼šå›é€€åˆ° `propDecidable` ã€‚

`[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")` ç±»å‹ç±»è¿˜ä¸ºè¯æ˜å®šç†æä¾›äº†ä¸€äº›å°è§„æ¨¡çš„è‡ªåŠ¨åŒ–ã€‚ æ ‡å‡†åº“å¼•å…¥äº† `decide` ç­–ç•¥ï¼Œå®ƒä½¿ç”¨ `[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")` å®ä¾‹æ¥è§£å†³ç®€å•çš„ç›®æ ‡ï¼Œ ä»¥åŠä¸€ä¸ª `[decide](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___decide "Documentation for Decidable.decide in Lean Language Reference")` å‡½æ•°ï¼Œå®ƒä½¿ç”¨ `[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")` å®ä¾‹æ¥è®¡ç®—ç›¸åº”çš„ `[Bool](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Booleans/#Bool___false "Documentation for Bool in Lean Language Reference")` ã€‚

`example:10<5âˆ¨1>0:=âŠ¢ 10[<](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#LT___mk "Documentation for LT.lt in Lean Language Reference")5[âˆ¨](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Logical-Connectives/#Or___inl "Documentation for Or in Lean Language Reference")1>0All goals completed! ğŸ™` `example:Â¬([True](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Truth/#True___intro "Documentation for True in Lean Language Reference")âˆ§[False](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Truth/#False "Documentation for False in Lean Language Reference")):=âŠ¢ [Â¬](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Logical-Connectives/#Not "Documentation for Not in Lean Language Reference")[(](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Logical-Connectives/#And___intro "Documentation for And in Lean Language Reference")[True](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Truth/#True___intro "Documentation for True in Lean Language Reference")[âˆ§](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Logical-Connectives/#And___intro "Documentation for And in Lean Language Reference")[False](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Truth/#False "Documentation for False in Lean Language Reference")[)](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Logical-Connectives/#And___intro "Documentation for And in Lean Language Reference")All goals completed! ğŸ™` `example:10*20=200:=âŠ¢ 10[*](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")20[=](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Propositional-Equality/#Eq___refl "Documentation for Eq in Lean Language Reference")200All goals completed! ğŸ™` `theoremex:[True](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Truth/#True___intro "Documentation for True in Lean Language Reference")âˆ§2=1+1:=âŠ¢ [True](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Truth/#True___intro "Documentation for True in Lean Language Reference")[âˆ§](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Logical-Connectives/#And___intro "Documentation for And in Lean Language Reference")2[=](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Propositional-Equality/#Eq___refl "Documentation for Eq in Lean Language Reference")1[+](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HAdd___mk "Documentation for HAdd.hAdd in Lean Language Reference")1All goals completed! ğŸ™` `` `theoremex : [True](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Truth/#True___intro "Documentation for True in Lean Language Reference")[âˆ§](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Logical-Connectives/#And___intro "Documentation for And in Lean Language Reference")2[=](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Propositional-Equality/#Eq___refl "Documentation for Eq in Lean Language Reference")1[+](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HAdd___mk "Documentation for HAdd.hAdd in Lean Language Reference")1 :=of_decide_eq_true(id([Eq.refl](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Propositional-Equality/#Eq___refl "Documentation for Eq.refl in Lean Language Reference")[true](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Booleans/#Bool___false "Documentation for Bool.true in Lean Language Reference")))`#printex ``
```
theorem ex : True âˆ§ 2 = 1 + 1 :=
of_decide_eq_true (id (Eq.refl true))
```
`` `@of_decide_eq_true : âˆ€{p:Prop}[inst:[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")p],[decide](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___decide "Documentation for Decidable.decide in Lean Language Reference")p[=](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Propositional-Equality/#Eq___refl "Documentation for Eq in Lean Language Reference")[true](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Booleans/#Bool___false "Documentation for Bool.true in Lean Language Reference")â†’p`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")@of_decide_eq_true ``
```
@of_decide_eq_true : âˆ€ {p : Prop} [inst : Decidable p], decide p = true â†’ p
```
`` `[decide](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___decide "Documentation for Decidable.decide in Lean Language Reference") : (p:Prop)â†’[h:[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")p]â†’[Bool](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Booleans/#Bool___false "Documentation for Bool in Lean Language Reference")`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")@decide ``
```
decide : (p : Prop) â†’ [h : Decidable p] â†’ Bool
```

## 10.9. ç®¡ç†ç±»å‹ç±»æ¨å¯¼ğŸ”—

å¦‚æœä½ é‡åˆ°éœ€è¦æä¾›ä¸€ä¸ª Lean å¯ä»¥é€šè¿‡ç±»å‹ç±»æ¨å¯¼å‡ºçš„è¡¨è¾¾å¼çš„æƒ…å†µï¼Œ ä½ å¯ä»¥è¦æ±‚ Lean ä½¿ç”¨ `[inferInstance](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Synthesis/#inferInstance "Documentation for inferInstance in Lean Language Reference")` æ¥æ‰§è¡Œæ¨å¯¼ï¼š

`deffoo:[Add](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Add___mk "Documentation for Add in Lean Language Reference")[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference"):=[inferInstance](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Synthesis/#inferInstance "Documentation for inferInstance in Lean Language Reference")` `defbar:[Inhabited](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Inhabited___mk "Documentation for Inhabited in Lean Language Reference")([Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")â†’[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")):=[inferInstance](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Synthesis/#inferInstance "Documentation for inferInstance in Lean Language Reference")` `` `[@](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Synthesis/#inferInstance "Documentation for inferInstance in Lean Language Reference")[inferInstance](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Synthesis/#inferInstance "Documentation for inferInstance in Lean Language Reference") : {Î±:Sort u_1}â†’[i:Î±]â†’Î±`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")@inferInstance ``
```
@inferInstance : {Î± : Sort u_1} â†’ [i : Î±] â†’ Î±
```

ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨è¾…åŠ©å®šä¹‰ `[inferInstanceAs](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Synthesis/#inferInstanceAs "Documentation for inferInstanceAs in Lean Language Reference")` ï¼š

`` `[inferInstanceAs](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Synthesis/#inferInstanceAs "Documentation for inferInstanceAs in Lean Language Reference")([Add](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Add___mk "Documentation for Add in Lean Language Reference")[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")) : [Add](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Add___mk "Documentation for Add in Lean Language Reference")[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")[inferInstanceAs](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Synthesis/#inferInstanceAs "Documentation for inferInstanceAs in Lean Language Reference")([Add](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Add___mk "Documentation for Add in Lean Language Reference")[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")) ``
```
inferInstanceAs (Add Nat) : Add Nat
```
`` `[inferInstanceAs](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Synthesis/#inferInstanceAs "Documentation for inferInstanceAs in Lean Language Reference") : (Î±:Sort u_1)â†’[i:Î±]â†’Î±`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")@inferInstanceAs ``
```
inferInstanceAs : (Î± : Sort u_1) â†’ [i : Î±] â†’ Î±
```

`defSet(Î±:Typeu):=Î±â†’Prop` ``/-- error: failed to synthesize   Inhabited (Set Î±)  Hint: Additional diagnostic information may be available using the `set_option diagnostics true` command. -/[#guard_msgs](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___guardMsgsCmd "Documentation for syntax in Lean Language Reference")[in](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___guardMsgsCmd "Documentation for syntax in Lean Language Reference")example:[Inhabited](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Inhabited___mk "Documentation for Inhabited in Lean Language Reference")(SetÎ±):=[inferInstance](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Synthesis/#inferInstance "Documentation for inferInstance in Lean Language Reference")`` `instance:[Inhabited](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Inhabited___mk "Documentation for Inhabited in Lean Language Reference")(SetÎ±):=[inferInstanceAs](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Synthesis/#inferInstanceAs "Documentation for inferInstanceAs in Lean Language Reference")([Inhabited](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Inhabited___mk "Documentation for Inhabited in Lean Language Reference")(Î±â†’Prop))`

æœ‰æ—¶ï¼Œä½ å¯èƒ½ä¼šå‘ç°ç±»å‹ç±»æ¨å¯¼æ— æ³•æ‰¾åˆ°é¢„æœŸçš„å®ä¾‹ï¼Œæˆ–è€…æ›´ç³Ÿç³•çš„æ˜¯ï¼Œé™·å…¥æ— é™å¾ªç¯å¹¶è¶…æ—¶ã€‚ ä¸ºäº†åœ¨è¿™äº›æƒ…å†µä¸‹å¸®åŠ©è°ƒè¯•ï¼ŒLean å…è®¸ä½ è¯·æ±‚æœç´¢çš„è¿½è¸ªï¼š

`set_optiontrace.Meta.synthInstancetrue`

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ VS Codeï¼Œä½ å¯ä»¥é€šè¿‡å°†é¼ æ ‡æ‚¬åœåœ¨ç›¸å…³çš„å®šç†æˆ–å®šä¹‰ä¸Šï¼Œ æˆ–è€…ä½¿ç”¨ `Ctrl` `Shift` `Enter` æ‰“å¼€æ¶ˆæ¯çª—å£æ¥è¯»å–ç»“æœã€‚

ä½ è¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹é€‰é¡¹é™åˆ¶æœç´¢ï¼š

`set_option[synthInstance.maxHeartbeats](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Synthesis/#synthInstance___maxHeartbeats "Documentation for option synthInstance.maxHeartbeats in Lean Language Reference")10000` `set_optionsynthInstance.maxSize400`

é€‰é¡¹ `synthInstance.maxHeartbeats` æŒ‡å®šäº†æ¯ä¸ªç±»å‹ç±»è§£æé—®é¢˜çš„æœ€å¤§å¿ƒè·³æ•°ã€‚ å¿ƒè·³æ˜¯ï¼ˆå°çš„ï¼‰å†…å­˜åˆ†é…æ¬¡æ•°ï¼ˆä»¥åƒä¸ºå•ä½ï¼‰ï¼Œ0 è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ã€‚ é€‰é¡¹ `synthInstance.maxSize` æ˜¯åœ¨ç±»å‹ç±»å®ä¾‹åˆæˆè¿‡ç¨‹ä¸­ç”¨äºæ„é€ è§£å†³æ–¹æ¡ˆçš„æœ€å¤§å®ä¾‹æ•°ã€‚

è¿˜è¦è®°ä½ï¼Œåœ¨ VS Code å’Œ Emacs ç¼–è¾‘å™¨æ¨¡å¼ä¸‹ï¼ŒTab è¡¥å…¨åœ¨ `set_option` ä¸­éƒ½æœ‰æ•ˆï¼Œ å¯ä»¥å¸®åŠ©ä½ æ‰¾åˆ°åˆé€‚çš„é€‰é¡¹ã€‚

å¦‚ä¸Šæ‰€è¿°ï¼Œç»™å®šä¸Šä¸‹æ–‡ä¸­çš„ç±»å‹ç±»å®ä¾‹ä»£è¡¨ä¸€ä¸ªç±»ä¼¼äº Prolog çš„ç¨‹åºï¼Œå®ƒä¼šå¼•èµ·å›æº¯æœç´¢ã€‚ ç¨‹åºçš„æ•ˆç‡å’Œæ‰¾åˆ°çš„è§£å†³æ–¹æ¡ˆéƒ½å–å†³äºç³»ç»Ÿå°è¯•å®ä¾‹çš„é¡ºåºã€‚æœ€åå£°æ˜çš„å®ä¾‹æœ€å…ˆè¢«å°è¯•ã€‚ æ­¤å¤–ï¼Œå¦‚æœå®ä¾‹æ˜¯åœ¨å…¶ä»–æ¨¡å—ä¸­å£°æ˜çš„ï¼Œåˆ™å°è¯•å®ƒä»¬çš„é¡ºåºå–å†³äºæ‰“å¼€å‘½åç©ºé—´çš„é¡ºåºã€‚ åœ¨è¾ƒæ™šæ‰“å¼€çš„å‘½åç©ºé—´ä¸­å£°æ˜çš„å®ä¾‹ä¼šè¾ƒæ—©è¢«å°è¯•ã€‚

ä½ å¯ä»¥é€šè¿‡ä¸ºç±»å‹ç±»å®ä¾‹åˆ†é… *ä¼˜å…ˆçº§* æ¥æ›´æ”¹å°è¯•å®ƒä»¬çš„é¡ºåºã€‚ å£°æ˜å®ä¾‹æ—¶ï¼Œä¼šä¸ºå…¶åˆ†é…é»˜è®¤ä¼˜å…ˆçº§å€¼ã€‚å®šä¹‰å®ä¾‹æ—¶ï¼Œä½ å¯ä»¥åˆ†é…å…¶ä»–ä¼˜å…ˆçº§ã€‚ ä»¥ä¸‹ç¤ºä¾‹è¯´æ˜äº†å¦‚ä½•æ‰§è¡Œæ­¤æ“ä½œï¼š

`classFoowherea:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")b:[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")` `instance(priority:=[default](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Declarations/#prioDefault "Documentation for syntax in Lean Language Reference")+1)i1:Foowherea:=1[b](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Foo-next "Definition of example"):=1` `instancei2:Foowherea:=2[b](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Foo-next "Definition of example"):=2` `example:Foo.a=1:=[rfl](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Propositional-Equality/#rfl-next "Documentation for rfl in Lean Language Reference")` `instance(priority:=[default](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Instance-Declarations/#prioDefault "Documentation for syntax in Lean Language Reference")+2)i3:Foowherea:=3[b](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Foo-next "Definition of example"):=3` `example:Foo.a=3:=rfl`

## 10.10. ä½¿ç”¨ç±»å‹ç±»çš„å¼ºåˆ¶è½¬æ¢ğŸ”—

Lean å…è®¸æˆ‘ä»¬å£°æ˜ä¸‰ç§å¼ºåˆ¶è½¬æ¢ï¼š

- ä»ä¸€ä¸ªç±»å‹æ—åˆ°å¦ä¸€ä¸ªç±»å‹æ—
- ä»ä¸€ä¸ªç±»å‹æ—åˆ° Sort ç±»
- ä»ä¸€ä¸ªç±»å‹æ—åˆ°å‡½æ•°ç±»å‹ç±»

ç¬¬ä¸€ç§å¼ºåˆ¶è½¬æ¢å…è®¸æˆ‘ä»¬å°†æºæ—æˆå‘˜çš„ä»»ä½•å…ƒç´ è§†ä¸ºç›®æ ‡æ—ç›¸åº”æˆå‘˜çš„å…ƒç´ ã€‚ ç¬¬äºŒç§å¼ºåˆ¶è½¬æ¢å…è®¸æˆ‘ä»¬å°†æºæ—æˆå‘˜çš„ä»»ä½•å…ƒç´ è§†ä¸ºç±»å‹ã€‚ ç¬¬ä¸‰ç§å¼ºåˆ¶è½¬æ¢å…è®¸æˆ‘ä»¬å°†æºæ—çš„ä»»ä½•å…ƒç´ è§†ä¸ºå‡½æ•°ã€‚è®©æˆ‘ä»¬ä¾æ¬¡è€ƒè™‘è¿™äº›ã€‚

åœ¨ Lean ä¸­ï¼Œå¼ºåˆ¶è½¬æ¢æ˜¯åœ¨ç±»å‹ç±»è§£ææ¡†æ¶ä¹‹ä¸Šå®ç°çš„ã€‚ æˆ‘ä»¬é€šè¿‡å£°æ˜ `[Coe](https://lean-lang.org/doc/reference/4.26.0/Coercions/#Coe___mk "Documentation for Coe in Lean Language Reference")Î±Î²` çš„å®ä¾‹æ¥å®šä¹‰ä» `Î±` åˆ° `Î²` çš„å¼ºåˆ¶è½¬æ¢ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä» `[Bool](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Booleans/#Bool___false "Documentation for Bool in Lean Language Reference")` åˆ° `Prop` çš„å¼ºåˆ¶è½¬æ¢å¦‚ä¸‹ï¼š

`instance:[Coe](https://lean-lang.org/doc/reference/4.26.0/Coercions/#Coe___mk "Documentation for Coe in Lean Language Reference")[Bool](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Booleans/#Bool___false "Documentation for Bool in Lean Language Reference")Propwhere[coe](https://lean-lang.org/doc/reference/4.26.0/Coercions/#Coe___mk "Documentation for Coe.coe in Lean Language Reference")b:=b=[true](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Booleans/#Bool___false "Documentation for Bool.true in Lean Language Reference")`

è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿåœ¨ `if` - `then` - `else` è¡¨è¾¾å¼ä¸­ä½¿ç”¨å¸ƒå°”é¡¹ï¼š

`defList.toSet:[List](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Linked-Lists/#List___nil "Documentation for List in Lean Language Reference")Î±â†’SetÎ±|[]=>[Set.empty](https://www.leanprover.cn/tp-lean-zh/TypeClasses/AxiomsComputation/#Set___empty "Definition of example")|a::as=>{a}âˆªas.[toSet](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#List___toSet "Definition of example")` `instance:[Coe](https://lean-lang.org/doc/reference/4.26.0/Coercions/#Coe___mk "Documentation for Coe in Lean Language Reference")([List](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Linked-Lists/#List___nil "Documentation for List in Lean Language Reference")Î±)(SetÎ±)where[coe](https://lean-lang.org/doc/reference/4.26.0/Coercions/#Coe___mk "Documentation for Coe.coe in Lean Language Reference")a:=a.[toSet](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#List___toSet "Definition of example")` `defs:Set[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference"):={1}` `` `sâˆª[2[,](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Linked-Lists/#List___nil "Documentation for List.cons in Lean Language Reference")3[]](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Linked-Lists/#List___nil "Documentation for List.cons in Lean Language Reference").[toSet](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#List___toSet "Definition of example") : Set[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")sâˆª[2,3] ``
```
s âˆª [2, 3].toSet : Set Nat
```

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¬¦å· `â†‘` æ¥å¼ºåˆ¶åœ¨ç‰¹å®šä½ç½®å¼•å…¥å¼ºåˆ¶è½¬æ¢ã€‚ è¿™ä¹Ÿæœ‰åŠ©äºæ˜ç¡®æˆ‘ä»¬çš„æ„å›¾ï¼Œå¹¶ç»•è¿‡å¼ºåˆ¶è½¬æ¢è§£æç³»ç»Ÿçš„é™åˆ¶ã€‚

`defs:Set[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference"):={1}` `` `letx:=[2[,](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Linked-Lists/#List___nil "Documentation for List.cons in Lean Language Reference")3[]](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Linked-Lists/#List___nil "Documentation for List.cons in Lean Language Reference").[toSet](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#List___toSet "Definition of example");sâˆªx : Set[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")letx:=â†‘[2,3];sâˆªx ``
```
let x := [2, 3].toSet;
s âˆª x : Set Nat
```
`` `letx:=[2[,](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Linked-Lists/#List___nil "Documentation for List.cons in Lean Language Reference")3[]](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Linked-Lists/#List___nil "Documentation for List.cons in Lean Language Reference");sâˆªx.[toSet](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#List___toSet "Definition of example") : Set[Nat](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Natural-Numbers/#Nat___zero "Documentation for Nat in Lean Language Reference")`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")letx:=[2,3];sâˆªx ``
```
let x := [2, 3];
s âˆª x.toSet : Set Nat
```

Lean è¿˜æ”¯æŒä½¿ç”¨ç±»å‹ç±» `[CoeDep](https://lean-lang.org/doc/reference/4.26.0/Coercions/Coercing-Between-Types/#CoeDep___mk "Documentation for CoeDep in Lean Language Reference")` çš„ä¾èµ–å¼ºåˆ¶è½¬æ¢ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä¸èƒ½å°†ä»»æ„å‘½é¢˜å¼ºåˆ¶è½¬æ¢ä¸º `[Bool](https://lean-lang.org/doc/reference/4.26.0/Basic-Types/Booleans/#Bool___false "Documentation for Bool in Lean Language Reference")` ï¼Œåªèƒ½å°†å®ç°äº† `[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")` ç±»å‹ç±»çš„å‘½é¢˜è¿›è¡Œè½¬æ¢ã€‚

`instance(p:Prop)[[Decidable](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___isFalse "Documentation for Decidable in Lean Language Reference")p]:[CoeDep](https://lean-lang.org/doc/reference/4.26.0/Coercions/Coercing-Between-Types/#CoeDep___mk "Documentation for CoeDep in Lean Language Reference")ProppBoolwhere[coe](https://lean-lang.org/doc/reference/4.26.0/Coercions/Coercing-Between-Types/#CoeDep___mk "Documentation for CoeDep.coe in Lean Language Reference"):=[decide](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Decidable___decide "Documentation for Decidable.decide in Lean Language Reference")p`

Lean è¿˜ä¼šæ ¹æ®éœ€è¦é“¾æ¥ï¼ˆéä¾èµ–ï¼‰å¼ºåˆ¶è½¬æ¢ã€‚å®é™…ä¸Šï¼Œç±»å‹ç±» `[CoeT](https://lean-lang.org/doc/reference/4.26.0/Coercions/Coercing-Between-Types/#CoeT___mk "Documentation for CoeT in Lean Language Reference")` æ˜¯ `[Coe](https://lean-lang.org/doc/reference/4.26.0/Coercions/#Coe___mk "Documentation for Coe in Lean Language Reference")` çš„ä¼ é€’é—­åŒ…ã€‚

ç°åœ¨è®©æˆ‘ä»¬è€ƒè™‘ç¬¬äºŒç§å¼ºåˆ¶è½¬æ¢ã€‚æ‰€è°“ *Sort ç±»* ï¼Œæˆ‘ä»¬æŒ‡çš„æ˜¯å®‡å®™é›†åˆ `Typeu` ã€‚ç¬¬äºŒç§å¼ºåˆ¶è½¬æ¢çš„å½¢å¼å¦‚ä¸‹ï¼š

```
c : (x1 : A1) â†’ ... â†’ (xn : An) â†’ F x1 ... xn â†’ Type u
```

å…¶ä¸­ `F` æ˜¯å¦‚ä¸Šæ‰€è¿°çš„ç±»å‹æ—ã€‚è¿™å…è®¸æˆ‘ä»¬åœ¨ `t` çš„ç±»å‹ä¸º `F aâ‚ ... aâ‚™` æ—¶å†™å‡º `s : t` ã€‚ æ¢å¥è¯è¯´ï¼Œå¼ºåˆ¶è½¬æ¢å…è®¸æˆ‘ä»¬å°† `F aâ‚ ... aâ‚™` çš„å…ƒç´ è§†ä¸ºç±»å‹ã€‚ è¿™åœ¨å®šä¹‰ä»£æ•°ç»“æ„æ—¶éå¸¸æœ‰ç”¨ï¼Œå…¶ä¸­ä¸€ä¸ªç»„ä»¶ï¼ˆç»“æ„çš„è½½ä½“ï¼‰æ˜¯ä¸€ä¸ª `Type` ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å¦‚ä¸‹å®šä¹‰ä¸€ä¸ªåŠç¾¤ï¼š

`structureSemigroupwherecarrier:Typeumul:carrierâ†’carrierâ†’carriermul_assoc(abc:carrier):mul(mulab)c=mula(mulbc)` `instance(S:Semigroup):[Mul](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Mul___mk "Documentation for Mul in Lean Language Reference")S.carrierwhere[mul](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#Mul___mk "Documentation for Mul.mul in Lean Language Reference")ab:=S.mulab`

`` `Semigroup.carrier.{u}(self:Semigroup):Type u`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")Semigroup.carrier ``
```
Semigroup.carrier.{u} (self : Semigroup) : Type u
```

`instance:[CoeSort](https://lean-lang.org/doc/reference/4.26.0/Coercions/Coercing-to-Sorts/#CoeSort___mk "Documentation for CoeSort in Lean Language Reference")Semigroup(Typeu)where[coe](https://lean-lang.org/doc/reference/4.26.0/Coercions/Coercing-to-Sorts/#CoeSort___mk "Documentation for CoeSort.coe in Lean Language Reference")s:=s.carrier` `example(S:Semigroup)(abc:S):(a*b)*c=a*(b*c):=Semigroup.mul_assoc_abc`

æ‰€è°“ *å‡½æ•°ç±»å‹ç±»* ï¼Œæˆ‘ä»¬æŒ‡çš„æ˜¯ Pi ç±»å‹ `(z:B)â†’C` çš„é›†åˆã€‚ ç¬¬ä¸‰ç§å¼ºåˆ¶è½¬æ¢çš„å½¢å¼å¦‚ä¸‹ï¼š

```
c : (xâ‚ : Aâ‚) â†’ ... â†’ (xâ‚™ : Aâ‚™) â†’ (y : F xâ‚ ... xâ‚™) â†’ (z : B) â†’ C
```

`structureMorphism(S1S2:Semigroup)wheremor:S1â†’S2resp_mul:âˆ€ab:S1,mor(a*b)=(mora)*(morb)` `` `[@](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")[Morphism.mor](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example") : {S1:Semigroup}â†’{S2:Semigroup}â†’[Morphism](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")S1S2â†’S1.carrierâ†’S2.carrier`[#check](https://lean-lang.org/doc/reference/4.26.0/Interacting-with-Lean/#Lean___Parser___Command___check "Documentation for syntax in Lean Language Reference")@Morphism.mor ``
```
@Morphism.mor : {S1 : Semigroup} â†’ {S2 : Semigroup} â†’ Morphism S1 S2 â†’ S1.carrier â†’ S2.carrier
```

`instance(S1S2:Semigroup):[CoeFun](https://lean-lang.org/doc/reference/4.26.0/Coercions/Coercing-to-Function-Types/#CoeFun___mk "Documentation for CoeFun in Lean Language Reference")([Morphism](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")S1S2)(fun_=>S1â†’S2)where[coe](https://lean-lang.org/doc/reference/4.26.0/Coercions/Coercing-to-Function-Types/#CoeFun___mk "Documentation for CoeFun.coe in Lean Language Reference")m:=m.[mor](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")` `theoremresp_mul{S1S2:Semigroup}(f:[Morphism](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")S1S2)(ab:S1):f(a*b)=fa*fb:=f.[resp_mul](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")ab` `example(S1S2:Semigroup)(f:[Morphism](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")S1S2)(a:S1):f(a*a*a)=fa*fa*fa:=calcf(a*a*a)_=f(a*a)*fa:=S1:SemigroupS2:Semigroupf:[Morphism](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")S1S2a:S1.carrierâŠ¢ f.[mor](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")[(](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")a[*](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")a[*](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")a[)](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")[=](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Propositional-Equality/#Eq___refl "Documentation for Eq in Lean Language Reference")f.[mor](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")[(](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")a[*](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")a[)](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")[*](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")f.[mor](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")aAll goals completed! ğŸ™_=fa*fa*fa:=S1:SemigroupS2:Semigroupf:[Morphism](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")S1S2a:S1.carrierâŠ¢ f.[mor](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")[(](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")a[*](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")a[)](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")[*](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")f.[mor](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")a[=](https://lean-lang.org/doc/reference/4.26.0/Basic-Propositions/Propositional-Equality/#Eq___refl "Documentation for Eq in Lean Language Reference")f.[mor](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")a[*](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")f.[mor](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")a[*](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")f.[mor](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")aAll goals completed! ğŸ™`

æœ‰äº†å¼ºåˆ¶è½¬æ¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™å‡º `f(a*a*a)` è€Œä¸æ˜¯ `f.[mor](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")[(](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")a[*](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")a[*](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")a[)](https://lean-lang.org/doc/reference/4.26.0/Type-Classes/Basic-Classes/#HMul___mk "Documentation for HMul.hMul in Lean Language Reference")` ã€‚ å½“åœ¨éœ€è¦å‡½æ•°çš„åœ°æ–¹ä½¿ç”¨ `[Morphism](https://www.leanprover.cn/tp-lean-zh/TypeClasses/TypeClasses/#Morphism "Definition of example")` `f` æ—¶ï¼ŒLean ä¼šæ’å…¥å¼ºåˆ¶è½¬æ¢ã€‚ ä¸ `[CoeSort](https://lean-lang.org/doc/reference/4.26.0/Coercions/Coercing-to-Sorts/#CoeSort___mk "Documentation for CoeSort in Lean Language Reference")` ç±»ä¼¼ï¼Œæˆ‘ä»¬è¿˜æœ‰å¦ä¸€ä¸ªç±» `[CoeFun](https://lean-lang.org/doc/reference/4.26.0/Coercions/Coercing-to-Function-Types/#CoeFun___mk "Documentation for CoeFun in Lean Language Reference")` ç”¨äºæ­¤ç±»å¼ºåˆ¶è½¬æ¢ã€‚ å‚æ•° `Î³` ç”¨äºæŒ‡å®šæˆ‘ä»¬è¦å¼ºåˆ¶è½¬æ¢åˆ°çš„å‡½æ•°ç±»å‹ã€‚è¯¥ç±»å‹å¯èƒ½å–å†³äºæˆ‘ä»¬è¦å¼ºåˆ¶è½¬æ¢çš„ç±»å‹ã€‚